\chapter{Allgemeines}

Software ist in den letzten Jahren allgegenwärtig geworden. Der Siegeszug verbundener Systeme, wie dem Internet,  ist unaufhaltsam. Der freie Zugriff auf Informationen und das neue Level an Verbundenheit führt zu sozialen und ökonomischen Entwicklungen deren Auswirkungen teilweise nicht absehbar sind. Es sind interessante Zeiten, in denen wir leben, wir (als Informatiker bzw. die Leser dieses Dokumentes) sind Teil einer privilegierten Schicht und dürfen auch den Anspruch erheben, Teil dieses Wandels zu sein. Im ursprünglichen Sinn des Wortes, waren Hacker Personen, die Spaß an der Arbeit mit neuen Technologien hatten, diese auch zweckentfremdeten --- \textit{The Street will find its own uses for things} wie William Gibson richtig bemerkte.

Technologie verbessert das Leben der Menschen, beinhaltet aber auch Risiken. Durch die Allgegenwärtigkeit von Software wurden und werden Personen von dieser abhängig. Fehler gefährden Menschen und Ökonomie. Gerade weil Software so vielseitig ist, können auch vielseitige Fehler entstehen. Wenn diese bösartig ausgenutzt werden\footnote{Subjektiv im Auge des Betrachters.} ist der Schritt vom Hacker zum Cracker vollzogen. \textit{With great power comes great responsibility} --- dies gilt auch für Softwareentwickler. Ich selbst hielt mich für einen guten Softwareentwickler, wurde Penetration-Tester und sah meinen ehemaligen Code mit neuen Augen. Meine Meinung über mich selbst änderte sich rapide.

Im Frühjahr 2019 erhielt ich das Angebot, an der FH/Technikum Wien einen Kurs \textit{Web Security} zu halten und hoffe, dass ich damit einen kleinen Teil betrage, die sub-optimale Sicherheitssituation zu verbessern. Dieses Dokument dient als Skript, auch weil ich befürchte, während des Vortrags wichtige Punkte zu übersehen bzw. als Möglichkeit Basisinformationen aus der Vorlesung auszulagern. Es gibt leider zu viele Schwachstellen und zu wenig Zeit um jede durchzugehen. Ein Beweggrund für mich auf der Fachhochschule zu unterrichten ist, dass wir alle Fehler machen\ldots unser Ausbildungsniveau sollte zumindest so gut sein, dass wir zumindest interessante Fehler begehen.

Ich spüre aber auch die Angst, etwas zu veröffentlichen das potentiell Fehler beinhaltet oder auch teilweise meine Meinung widerspiegelt. Auch in der Webentwicklung gibt es keine perfekte Wahrheit, Dinge ändern sich. Ich habe dieses Skript nach der zweiten Iteration meiner Vorlesung, nach viel positivem Feedback sowohl durch Foren als auch Studenten, 2020 offiziell höchst-nervös veröffentlicht.

Ich hoffe, dass die schlimmsten Missverständnisse bereits durch meine Studenten erkannt, und von mir ausgebessert, wurden. Wenn nicht, würde ich mich um ein kurzes Feedback unter \url{mailto:andreashappe@snikt.net} freuen. Ich sehe solch Feedback als essentiell dafür ein, dass meine zukünftigen Studenten einen guten Unterricht erhalten.

Die aktuelle Version dieses Dokumentes ist unter \url{https:/snikt.net/websec/} unter einer Creative-Commons Lizenz verfügbar. Der idente Inhalt wird von mir periodisch als neue Version als Amazon Kindle eBook veröffentlicht. Auf Anfrage einzelner Studenten werde ich dieses Skript auch als dead-tree Buch veröffentlichen. Leider ist das Update eines Papier-Buchs nicht so einfach möglich, aus diesem Grund habe ich einen niedrigen Buchpreis gewählt, der quasi der Gegenwert eines spendierten (belgischen) Biers ist. Ich hoffe, dies wird als fair empfunden.

\section{Struktur dieses Dokumentes}

Dieses Dokument und die dazugehörige Vorlesung verfolgt einen Top-Down Approach.

Beide beginnen mit high-level Themen, die beschreiben wie Security in die weitere Softwarewelt passt. Um eine Informations-Gleichheit zu schaffen, wird danach ein Kurzüberblick über die verschiedensten Webtechnologien geboten.

Der nächste Part (\textit{Authentication und Autorisierung}) behandelt high-level Fehler bei der Implementierung der Benutzer- und Berechtigungskontrolle. Drei Kapitel (\textit{Authentication}, \textit{Authorization}, \textit{Federation/Single Sign-On}) beschreiben Gebiete, die applikationsweit betrachtet werden müssen --- falls hierbei Fehler auftreten, ist zumeist die gesamte Applikation betroffen und gebrochen.

Im darauf folgenden Part (\textit{Injection Attacks}) wird auf verschiedene Injection-Angriffe eingegangen. Hier wurde zwischen Angriffen, die direkt gegen den Webserver, und Angriffen die einen Client (zumeist Webbrowser) benötigen, unterschieden. Während auch hier Schutzmaßnahmen am besten global für die gesamte Applikation durchgeführt werden sollten, betrifft hier eine Schwachstelle zumeist einzelne Operationen und kann dadurch auch lokal korrigiert werden.

\section{Weiterführende Informationen}

Dieses Dokument ist (und kann) nur eine grobe Einführung in Sicherheitsthemen bieten. Es ist als kurzweiliges Anfixen gedacht und soll weitere selbstständige Recherchen motivieren.

\subsection{What to read?}

Für weitere Informationen sind die Dokumente des OWASP\footnote{Open Web Application Security Project} empfehlenswert. OWASP selbst ist eine Non-Profit Organisation welche ursprünglich das Ziel hatte, die Sicherheit von Web-Anwendungen zu erhöhen, mittlerweile aber auch im Mobile Application bzw. IoT Umfeld tätig ist. Das bekannteste OWASP-Dokument sind wahrscheinlich die OWASP Top 10\footnote{\url{https://www.owasp.org/index.php/Category:OWASP_Top_Ten_Project}} welche eine Sammlung der 10 häufigsten Sicherheitsschwachstellen im Web sind.

Der OWASP Application Security Verification Standard\footnote{\url{https://www.owasp.org/index.php/Category:OWASP_Application_Security_Verification_Standard_Project}}, kurz ASVS, bietet eine Checkliste die von Penetration-Testern bzw. Software-Entwicklern verwendet werden kann, um Software auf die jeweiligen Gegenmaßnahmen für die OWASP Top 10 Angriffsvektoren zu testen. Der OWASP Testing Guide\footnote{\url{https://www.owasp.org/images/1/19/OTGv4.pdf}} liefert zu jedem Angriffsvektor Hintergrundinformationen, potentielle Testmöglichkeiten als auch Referenzen auf Gegenmaßnahmen. Dieser Guide sollte eher als Referenz und nicht als Einführungsdokument verwendet werden.

Um auf den aktuellen Stand im Bereich Web Security zu bleiben ist ein Besuch von \textit{The Daily Swig}\footnote{\url{https://portswigger.net/daily-swig}} von PortSwigger empfehlenswert. Die großen Topics dieser Nachrichtenseite sind Data Breaches, Vulnerabilites, Ransomware und technische Deep Dives.

\subsection{What to hack?}

Web Security kann nicht ausschließlich theoretisch gelehrt werden, wenn man in dem Umfeld aktiv sein will muss man hands-on Praxisbeispiele sehen und auch versuchen. Das Gefühl, bei einer Web-Applikation permanent mit dem Kopf gegen die Wand zu laufen, immer weider neue Angriffe erfolglos zu versuchen bis mein einen funktionierenden Angriff gefunden hat und sich nach erfolgter Ausnutzung zufrieden zurücklehnen kann, kann nur erlebt werden. Glückerlicher Weise gibt es mittlerweile eine Vielzahl an gratis bzw. freemium-basierten Webangeboten welche genau diese Gelegenheit bieten. Eine Auflistung dieser kann in folgender Tabelle vorgefunden werden\footnote{Ich habe mich bei dieser Liste auf Angebote welche, zumindest teilweise, gratis nutzbar sind, beschränkt, daher fehlt hier z. B. Offensive Security (\url{www.offensive-security.com}) obwohl diese von mir hoch geschätzt werden.}:


\begin{table}[h!]
	\begin{center}
\begin{tabular}{|l|l|lll|}
	\toprule
	Name & auch kommerziell & Online & VPN & VM \\
	\midrule
	Web Security Academy\footnote{\url{https://portswigger.net/web-security}}  & ja   & x &   &   \\
	Vulnhub\footnote{\url{https://www.vulnhub.com/}}              & nein &   &   & x \\
	Pentester lab\footnote{\url{https://pentesterlab.com/}}        & ja   & x &   & x \\
	Hack the Box\footnote{\url{https://www.hackthebox.eu/}}         & ja   & ~ & x &   \\
	\bottomrule
\end{tabular}
\end{center}
\end{table}

Die Spalten ,,online'', ,,VPN'' und ,,VM'' sollten darstellen, wie das jeweilige Angebot genutzt werden kann. ,,Online'' sind Kurse, bei denen eine verwundbare Webapplikation direkt über den Browser des Benutzers getestet werden kann: es muss nicht zwingend am lokalen Rechner eine Virtualisierungslösung oder ähnliches installiert werden. Lösungen der Spalte ,,VM'' sind das genaue Gegenteil: hier kann zumeist eine virtuelle Maschine bezogen und lokal installiert werden. In dieser virtuellen Maschine befindet sich die zu testende Software. In diesem Fall benötigt man zwar lokal installierte Virtualisierungssoftware, dafür ist man allerdings von der Internet-/Netzwerkverbindungsqualität großteils unabhängig. ,,VPN''-Lösungen sind eine Mischform: bei diesen erhält man Zugangsdaten für einen VPN-Einwahlknoten und gelangt über diesen zu einem virtuellen Labornetzwerk in welchem sich virtuelle Maschinen mit verwundbarer Software befinden. In diesem Fall muss man zwar lokal einen VPN-Client installieren, diese ist allerdings leichtgewichtiger als eine volle Virtualisierungslösung. Zusätzlich bieten ,,VPN''-basierte Ansätze auch teilweise größere Netzwerke in denen man auch Post-Exploitation Tätigkeiten wie Lateral Movement trainieren kann.

Im Scope unterscheiden sich die gelisteten Lösungen ebenso. Während \textit{Web Security Academy} und \textit{Pentester Lab} sich an klassichen Security-Schulungen anlehnen und auch die Theorie bzw. Hintergrundinformationen bieten, stellt bie \textit{VulnHub} und \textit{Hack the Box} das ,,Doing'', also das Hacken von Maschinen, im Vordergrund. Die beiden letztgenannten Plattformen bieten weniger Hintergrundinformationen, diese können aber im Normalfall durch Suche im Internet gefunden werden.

\subsection{What to attend?}

OWASP selbst ist in Städte-zentrischen Chapters organisiert, ich bin zum Beispiel beim OWASP Chapter Vienna (Austria) aktiv\footnote{\url{https://www.meetup.com/de-DE/OWASP-Vienna-Chapter/}}. Aktuell finden keine Stammtische aufgrund der COVID-19 Situation statt, es gibt allerdings immer wieder mal virtuelle Meetupgs.

\section{Out-of-Scope für dieses Skript}

Auf drei wichtige Bereiche wird im Zuge dieses Skripts nicht implizit eingegangen:

\subsection{Denial-of-Service Angriffe}

Denial-of-Service Angriffe zielen darauf ab, die Verfügbarkeit einer Applikation zu beeinträchtigen. Dadurch kann der Dienst nicht mehr benutzt bzw. konsumiert werden und dem Betreiber entstehen Kosten, z. B. Verdienstentgang durch einen ausgefallenen Webshop.

Ein DoS-Angriff zielt entweder auf eine Applikations-bezogene Ressource wie z. B. erlaubte Verbindungen pro Applikationsbenutzer oder eine fundamentale Systemressource wie z. B. CPU-Zeit, Speicher oder Netzwerkbandbreite ab. Als Applikationsentwickler kann man bei Ressourcen-intensiven Operationen mittels Rate-Limits die Situation leicht entschärfen.

In diesem Dokument wird nicht tiefer auf DoS-Angriffe eingegangen, da diese quasi die Holzhammermethode darstellen. Gerade gegenüber Angriffen gegen die Netzwerkbandbreite kann nur über kommerzielle Cloud- bzw. Rechenzentrenbetreiber entgegengewirkt werden. Diese sind kostspielig und es entsteht eine Asymmetrie: die Abwehr des Angriffs ist kostspieliger als der Angriff selbst. Somit wird aus einem technischen DoS ein monetärer DoS.

\subsection{Security und Usability}

Es gibt das Vorurteil, dass Sicherheit und Usability konträr sind. Während dies in wenigen bedauerlichen Einzelfällen gegeben sein kann, sollte dies nicht als Pauschalausrede zur Vermeidung vom Selbst-Denken missbraucht werden.

Der Benutzer will primär eine Aufgabe erledigen. Im Zuge der Erledigung dieser Aufgabe sollte Sicherheit nicht im Weg stehen. Stattdessen sollte der offensichtliche Weg der Aufgabenerledigung sicher implementiert sein und den Benutzer über einen sicheren Weg zur Erledigung der Aufgabe leiten. Falls sicherheitsrelevante Benutzerentscheidungen notwendig sind, sollten diese möglichst früh erfolgen --- wird dies während der Abarbeitung einer Aufgabe durchgeführt, kann der Benutzer so fokussiert sein, dass die Sicherheitsentscheidung nur peripher beachtet wird.

Ebenso sollte der Benutzer nicht mit irrelevanten Fragen bombardiert werden. Tests zeigen, dass dadurch nur der ``Meldung-wegklicken''-Reflex konditioniert wird. Die Willigkeit eines Benutzers, auf Sicherheit Rücksicht zu nehmen ist begrenzt, vergleichbar mit einer Batterie. Wenn diese erschöpft ist, wird weniger (oder gar keine) Rücksicht auf die Security genommen.

Ein besserer Weg ist es, per default sichere Prozesse zu implementieren und im Bedarfsfall unsichere Operationen durch den Benutzer explizit zu erlauben. Die dabei verwendeten Benutzerinteraktionen sollten dem NEAT-Prinzipien genügen:

\begin{itemize}
	\item Necessary: kann die Applikation, anstatt den Benutzer zu fragen, das Problem auf eine andere sichere Art und Wiese lösen?
	\item Explained: besitzt der Benutzer das notwendige Wissen um eine informierte Entscheidung zu treffen?
	\item Actionable: kann der Benutzer überhaupt sinnvoll auf die dargestellte Meldung reagieren?
	\item Tested: ist die Meldung innerhalb der UX sinnvoll und wurde getestet, ob sie in jeglicher Form von Benutzerfluss sinnvoll ist?
\end{itemize}

Im Zuge der DSGVO/GDPR wurde bestimmt, dass Software \textit{secure by design and default} sein muss. Dies bedeutet, dass Software die Möglichkeit einer sicheren Konfiguration bieten muss und diese im Auslieferungszustand auch sicher konfiguriert sein muss. Ein Beispiel das dagegen verstößt wäre der Einsatz von Default-Passwörtern.

\subsection{Ethical Web Development}

Technik an sich ist wertneutral. Sobald diese allerdings in Berührung mit der Realität kommt, entsteht ein ethischer Impact. Web Applikationen sind hier keine Ausnahme. Im Zuge des Skripts wird auf ethischen Impact nicht explizit eingegangen, da der Inhalt der Vorlesung das Werkzeug und nicht das Ziel des erstellten Werks ist.

Um trotzdem die ethische Dimension nicht zu vergessen, ein paar Richtlinien der EDRi\footnote{\url{https://edri.org/ethical-web-dev/}}:

\begin{description}
	\item[Allow as much data processing on an individual’s device as possible.] Dies würde im Web-Umfeld den Einsatz von JavaScript bedingen da nur auf diese Weise Daten direkt im Browser des Benutzers verarbeitet werden können.
	\item[Where you must deal with user data, use encryption.] Dies inkludiert sowohl Transport-Level Encryption (wie TLS) als auch Verschlüsselung der bearbeiteten Daten.
	\item[Where possible also use data minimisation methods.] Das Minimalprinzip sollte auch auf die gespeicherten Daten angewendet werden. Daten die eine Applikation nicht besitzt sind Daten, die auch nicht entwendet oder zweckentfremdet werden können.
	\item[Use first-party resources and avoid using third-party resources.] Es besteht die Sorge, dass externe Ressourcen modifiziert werden könnten. Dies soll durch die Verwendung eigener Ressourcen vermieden werden. Falls notwendig können CSP-Direktiven bzw. Subresource Integrity verwendet werden um die Integrität externer Ressourcen sicherzustellen.
\end{description}
